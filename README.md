# Auth app

## Описание
Сервис представляет собой приложение, в котором можно выполнить просмотр 
текущей зарплаты и даты следующего повышения. 
Доступ к данным возможен только для одного сотрудника.
Для обеспечения безопасности реализован метод, с помощью которого по 
логину и паролю сотрудника выдается секретный токен, который действует в 
течение определенного времени (в приложении время равно пяти минутам). 
Запрос данных о зарплате выдается только при предъявлении валидного токена.

Сервис состоит из двух частей:
- база данных (Postgres)
- REST-сервис

## Запуск

Для быстрой развертки приложения воспользуйтесь docker compose.
Для этого в консоли выполните команду:

```bash
cd <путь к корневой папке>
docker compose up
```

В результате выполнения команды будут подняты два контейнера:
- контейнер с БД (имя контейнера: cft-dbase-container)
- контейнер с REST-сервисом (имя контейнера: cft-app-container)

После развертки сервиса выполните проверку в браузере, перейдя по 
следующему url: http://127.0.0.1:8253/docs.

В результате выполнения этого запроса в браузере должна открыться 
главная страница Swagger

## Использование сервиса
После того, как сервис был поднят в Docker, можно приступить к его ручному 
тестированию.

При первом запуске сервиса база данных с информацией о пользователях пуста.
Для проверки работы имеющихся роутов нужно создать пользователя.
Для этой операции задан роут `user/add`.
Выполните запуск запроса через Swagger с заполненными полями в формате `json`:

```json
{
  "user": {
    "Name": "Michael Chernov",
    "Login": "mikko",
    "Password": "pretty-password"
  },
  "salary": {
    "Value": 180000,
    "TargetDate": "2023-09-01"
  }
}
```
Здесь:
- Namе - ФИО пользователя
- Login - логин учетной записи
- Password - пароль учетной записи
- Value - значение зарплаты
- TargetDate - дата повышения зарплаты

Теперь в системе есть хотя бы один пользователь.

Для возврата информации о зарплате используется роут `/salary`.

Если его выполнить без авторизации, сервер вернет ответ:
```json
{
  "detail": "Not authenticated"
}
```

Для корректной работы роута нужно выполнить авторизацию в Swagger-е, 
используя кнопку `Authorize`, а затем ввести в поле формы логин и пароль 
пользователя, который был создан ранее - 
`(login=mikko, password=pretty-password)`.

После авторизации выполнить запуск роута `salary`. В результате сервер 
вернет ответ в формате:

```json
{
  "UserID": 841,
  "Name": "Michael Chernov",
  "Salary": 180000,
  "TargetDate": "2023-09-01"
}
```
Здесь:

- UserID - id пользователя
- Name - полное имя пользователя
- Salary - размер зарплаты
- TargetDate - дата повышения зарплаты
